# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
# Clear console
cat("\014") 

# Packages
require(TukeyRegion)
require(MASS)


# Ler o arquivo txt do k-fold
#arq_tex <- read.table("C:\\Users\\megan\\Desktop\\Biblioteca Virtual\\Mestrado\\T?picos Aprendizado de M?quina\\fs4\\PerComiteOut.txt")
#print (head(arq_tex)) # ver o k-fold

# dat <- as.matrix(arq_tex)#, nrow = 9, ncol = 5) #Transformar o txt em matriz

X <- matrix(c(0.876407, 0.481571,  0.000000,
              0.984231, 0.176887,  0.000000,
              0.346188, 0.938165,  0.000000,
              0.970384, 0.241568,  0.333798,
              -0.217093, 0.976151,  -0.369736,
              -0.232021, 0.972711,  -0.063071,
              0.458197, 0.888851,  0.238046,
              0.049606, 0.998769,  0.240050,
              0.990028, -0.140871,  0.049160,
              0.219753, 0.975556,  -0.247349,
              0.672153, 0.740413,  -0.123119,
              0.280724, 0.959788,  -0.529360,
              0.461623, 0.887076,  -0.338873,
              0.991300, 0.131622,  -0.261818,
              0.716479, 0.697608,  0.183900,
              0.908531, 0.417818,  -0.253866,
              0.632890, 0.774241,  0.766956,
              0.513783, 0.857920,  -0.652576,
              -0.214454, 0.976734,  -0.633062,
              -0.056239, 0.998417,  0.656582,
              0.888000, 0.459843,  -0.838210,
              -0.032787, 0.999462,  -1.218217,
              0.831594, 0.555383,  -0.583609,
              0.990678, 0.136222,  -0.726691,
              0.990375, -0.138413,  -0.211474,
              0.061122, 0.998130,  -0.745267,
              0.425915, 0.904763,  -1.748313,
              0.997777, -0.066647,  0.310594,
              0.981954, 0.189118,  -1.458014,
              0.740278, 0.672301,  -1.122128,
              0.854761, 0.519022,  0.406587,
              0.686289, 0.727329,  0.463731,
              0.677740, 0.735301,  -0.429874,
              0.343098, 0.939300,  0.489413,
              0.847165, 0.531329,  0.952864,
              -0.328498, 0.944505,  -2.143798,
              -0.204356, 0.978897,  -1.018379,
              0.026686, 0.999644,  -0.068867,
              0.017619, 0.999845,  0.931172,
              0.198128, 0.980176,  1.135639,
              -0.206228, 0.978504,  -1.549031,
              -0.491312, 0.870984,  -1.530151,
              0.999968, -0.008015,  0.690498,
              0.460250, 0.887789,  -0.982305,
              0.515868, 0.856668,  -1.239105,
              0.354128, 0.935197,  0.793512,
              0.101250, 0.994861,  -1.954950,
              0.955198, 0.295968,  -0.487686,
              0.965036, 0.262116,  1.372368,
              -0.445970, 0.895048,  -1.788943,
              0.678658, 0.734454,  -0.851575,
              0.985259, 0.171069,  -1.043569,
              0.036124, 0.999347,  -0.433953,
              0.959346, 0.282233,  0.776705,
              0.726068, 0.687622,  -2.287341,
              0.721871, 0.692027,  -1.471593,
              0.869875, 0.493273,  1.247733,
              0.804645, 0.593756,  0.683589,
              -0.421909, 0.906638,  -0.831536,
              0.469004, 0.883196,  1.347649,
              0.096086, 0.995373,  -2.656186,
              0.905082, 0.425237,  -1.940375,
              0.321443, 0.946929,  1.839669,
              0.661998, 0.749506,  1.232602,
              0.235372, 0.971905,  -1.188697,
              0.998559, 0.053666,  1.144546,
              0.900356, 0.435154,  1.592047,
              0.878532, 0.477684,  -1.569408,
              0.216010, 0.976391,  1.577759,
              -0.231206, 0.972905,  -2.446381,
              0.998868, -0.047563,  -0.457803,
              0.275697, 0.961245,  -3.384529,
              0.795695, 0.605698,  1.851797,
              0.884322, 0.466878,  -2.534686,
              0.850708, 0.525638,  2.320490,
              0.792639, 0.609691,  2.719354,
              0.512676, 0.858582,  1.997006,
              0.572664, 0.819790,  1.675947,
              0.760782, 0.649008,  1.536801,
              0.980782, 0.195107,  1.867894,
              0.603077, 0.797683,  -3.281693,
              0.475153, 0.879903,  1.056536,
              0.889730, 0.456487,  -1.303130,
              0.347716, 0.937600,  -2.210005,
              0.509899, 0.860234,  -2.858870,
              0.887804, 0.460222,  2.058394,
              0.498516, 0.866880,  2.281558,
              -0.335793, 0.941936,  -1.259900,
              0.933941, 0.357427,  2.524560,
              0.713183, 0.700978,  -1.865463,
              0.184457, 0.982841,  -1.505163,
              0.782006, 0.623271,  -2.803320,
              0.030764, 0.999527,  -3.036502,
              0.700407, 0.713744,  2.437545,
              0.950191, 0.311668,  1.069859,
              0.740760, 0.671769,  2.105842,
              0.932607, 0.360894,  -2.249601,
              0.913693, 0.406405,  2.831803,
              0.971821, 0.235718,  -1.722766,
              0.507670, 0.861552,  -2.419313,
              0.969422, 0.245401,  2.185195), nrow = 101, ncol = 3, byrow = TRUE)

# Computar e vizualizar a regiao de Tukey
Tr1 <- TukeyRegion(X, 1, method = "cmb", 
                   retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)

plot(Tr1, colorFacets = "red", colorRidges = "red", 
     colorPoints = "blue", alpha = 0.35)

# print("O baricentro :")
# print (Tr1$barycenter)
# (Tr1$barycenter)
# #  media aritmetica
# T.mean <- colMeans(X)
# print("A media aritmetica :")
# print (T.mean)
# #  m?dia ponderada aparada de profundidade de Tukey (profundidade aproximada)
# T.approx1 <- depth.wm(X, 0.25)
# print ("A media ponderada : ")
# print (T.approx1)

# media ponderada aparada de profundidade de Tukey (profundidade exata)T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# print ("A media ponderada aparada de profundidade de Tukey: ")
# print (T.exact1)

# a mediana de TukeyTm <- TukeyMedian(X)
Tm <- TukeyMedian(X, algMedian = "bsbarydepth", 
                  method = "bfs",trgFacets = TRUE, 
                  retHalfspaces = FALSE, retHalfspacesNR = FALSE,
                  retInnerPoint = FALSE, retVertices = TRUE, 
                  retFacets = TRUE,retVolume = FALSE, 
                  retBarycenter = TRUE, 
                  verbosity = 1)
print ("A mediana de Tukey : ")
print (Tm$barycenter)
# B <- summary(Tm$barycenter)



# library("scatterplot3d") 
# 
# scatterplot3d(X, y=NULL, z=NULL,  angle = 30)



