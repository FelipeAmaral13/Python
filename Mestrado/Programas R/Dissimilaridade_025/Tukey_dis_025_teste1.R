# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
# Clear console
cat("\014") 

# Packages
require(TukeyRegion)
require(MASS)


# Ler o arquivo txt do k-fold
#arq_tex <- read.table("C:\\Users\\megan\\Desktop\\Biblioteca Virtual\\Mestrado\\T?picos Aprendizado de M?quina\\fs4\\PerComiteOut.txt")
#print (head(arq_tex)) # ver o k-fold

# dat <- as.matrix(arq_tex)#, nrow = 9, ncol = 5) #Transformar o txt em matriz

X <- matrix(c(-0.264067, 0.964504,  -0.154602,
              -0.038315, 0.999266,  -0.430185,
              0.991117, -0.132996,  0.000000,
              0.959262, 0.282519,  0.000000,
              0.578874, 0.815417,  0.372747,
              0.150501, 0.988610,  -0.192715,
              0.350484, 0.936569,  0.000000,
              0.693321, 0.720628,  0.000000,
              -0.106102, 0.994355,  0.117080,
              0.874830, 0.484431,  -0.368633,
              0.858296, 0.513155,  0.000000,
              0.418531, 0.908203,  -0.572115,
              0.998092, 0.061745,  -0.195625,
              0.997182, 0.075015,  0.343004,
              0.812887, 0.582421,  0.342983,
              0.907288, 0.420511,  0.633769,
              0.478401, 0.878142,  -0.252463,
              0.685881, 0.727714,  -0.416109,
              0.485932, 0.873996,  0.604412,
              0.987838, 0.155490,  -0.432470,
              0.148255, 0.988949,  0.272888,
              -0.482494, 0.875900,  -1.357169,
              0.857482, 0.514514,  -0.704198,
              0.644452, 0.764645,  1.121813,
              0.368256, 0.929725,  -0.950194,
              0.665772, 0.746155,  -0.808759,
              0.265406, 0.964137,  0.716325,
              0.995824, 0.091289,  0.853102,
              0.996375, 0.085069,  -0.839833,
              -0.306069, 0.952009,  -0.403493,
              0.672714, 0.739902,  -1.455689,
              0.313295, 0.949656,  -1.238703,
              0.180364, 0.983600,  0.997326,
              -0.037735, 0.999288,  0.630395,
              0.451714, 0.892163,  -1.782217,
              0.166469, 0.986047,  -0.678681,
              0.838570, 0.544793,  2.687562,
              0.948602, 0.316473,  0.267970,
              -0.202996, 0.979180,  -0.663026,
              0.968041, 0.250791,  1.461032,
              0.842756, 0.538296,  1.032090,
              0.497892, 0.867239,  0.863856,
              0.834421, 0.551128,  -2.707391,
              0.366813, 0.930295,  -2.246932,
              -0.140841, 0.990032,  0.382478,
              0.911100, 0.412186,  1.272924,
              0.733650, 0.679527,  -1.994080,
              0.066873, 0.997761,  -0.957778,
              0.111908, 0.993719,  -3.092704,
              0.997980, -0.063524,  -0.624084,
              0.771890, 0.635756,  0.619909,
              0.994328, 0.106357,  0.602764,
              0.677175, 0.735822,  1.454593,
              0.137763, 0.990465,  1.291676,
              0.864171, 0.503198,  -1.033047,
              0.880019, 0.474938,  2.357613,
              0.988288, 0.152602,  1.198272,
              0.835252, 0.549867,  2.121776,
              0.927497, 0.373830,  -2.315176,
              0.834583, 0.550882,  1.782100,
              0.377040, 0.926197,  1.863984,
              0.471954, 0.881623,  1.497091,
              0.911082, 0.412225,  -1.369283,
              0.967605, 0.252469,  2.124456,
              0.948618, 0.316425,  -1.849477,
              -0.354073, 0.935218,  -2.081101,
              0.723851, 0.689956,  2.453565,
              -0.299601, 0.954065,  -1.024820,
              0.653983, 0.756510,  -1.108538,
              0.594217, 0.804305,  1.702919,
              0.589297, 0.807916,  1.959067,
              -0.154601, 0.987977,  -1.286057,
              0.972290, 0.233780,  -1.083091,
              -0.013083, 0.999914,  -1.632065,
              0.982966, 0.183790,  1.730117,
              0.296876, 0.954916,  -2.854760,
              0.570960, 0.820978,  2.255151,
              0.668748, 0.743489,  -3.422378,
              0.983013, 0.183535,  -1.538714,
              0.393712, 0.919234,  1.143487,
              0.947213, 0.320606,  0.958221,
              0.476804, 0.879010,  -3.036596,
              -0.004296, 0.999991,  -1.979068,
              0.255147, 0.966902,  1.601740,
              0.993626, -0.112728,  -0.377439,
              0.881645, 0.471914,  3.075401,
              0.843900, 0.536500,  1.509544,
              0.714874, 0.699254,  0.873755,
              0.388053, 0.921637,  0.247470,
              -0.419561, 0.907727,  -0.784905,
              0.958182, 0.286160,  -0.672098,
              -0.418714, 0.908118,  -1.804184,
              0.219047, 0.975714,  -0.433066,
              0.437209, 0.899360,  -1.522588,
              0.191859, 0.981423,  -2.486977,
              -0.112276, 0.993677,  -2.435145,
              0.790325, 0.612688,  -2.231107,
              0.537970, 0.842964,  -2.650145,
              0.794431, 0.607355,  -1.688247,
              0.704590, 0.709614,  2.822108,
              -0.316924, 0.948451,  -1.554073), nrow = 101, ncol = 3, byrow = TRUE)

# Computar e vizualizar a regiao de Tukey
Tr1 <- TukeyRegion(X, 1, method = "cmb", 
                   retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)

plot(Tr1, colorFacets = "red", colorRidges = "red", 
     colorPoints = "blue", alpha = 0.35)

# print("O baricentro :")
# print (Tr1$barycenter)
# (Tr1$barycenter)
# #  media aritmetica
# T.mean <- colMeans(X)
# print("A media aritmetica :")
# print (T.mean)
# #  m?dia ponderada aparada de profundidade de Tukey (profundidade aproximada)
# T.approx1 <- depth.wm(X, 0.25)
# print ("A media ponderada : ")
# print (T.approx1)

# media ponderada aparada de profundidade de Tukey (profundidade exata)T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# print ("A media ponderada aparada de profundidade de Tukey: ")
# print (T.exact1)

# a mediana de TukeyTm <- TukeyMedian(X)
Tm <- TukeyMedian(X, algMedian = "bsbarydepth", 
                  method = "bfs",trgFacets = TRUE, 
                  retHalfspaces = FALSE, retHalfspacesNR = FALSE,
                  retInnerPoint = FALSE, retVertices = TRUE, 
                  retFacets = TRUE,retVolume = FALSE, 
                  retBarycenter = TRUE, 
                  verbosity = 1)
print ("A mediana de Tukey : ")
print (Tm$barycenter)
# B <- summary(Tm$barycenter)



# library("scatterplot3d") 
# 
# scatterplot3d(X, y=NULL, z=NULL,  angle = 30)



