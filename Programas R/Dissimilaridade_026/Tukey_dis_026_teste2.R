# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
# Clear console
cat("\014") 

# Packages
require(TukeyRegion)
require(MASS)


# Ler o arquivo txt do k-fold
#arq_tex <- read.table("C:\\Users\\megan\\Desktop\\Biblioteca Virtual\\Mestrado\\T?picos Aprendizado de M?quina\\fs4\\PerComiteOut.txt")
#print (head(arq_tex)) # ver o k-fold

# dat <- as.matrix(arq_tex)#, nrow = 9, ncol = 5) #Transformar o txt em matriz

X <- matrix(c(-0.230046, 0.973180,  -0.097228,
              0.317137, 0.948380,  0.000000,
              0.998623, -0.052456,  0.055883,
              0.918110, 0.396325,  0.000000,
              0.189188, 0.981941,  -0.274194,
              0.761974, 0.647608,  0.420246,
              0.075689, 0.997131,  0.207634,
              0.772569, 0.634931,  0.000000,
              0.988654, 0.150211,  -0.243805,
              0.980712, 0.195460,  0.503568,
              0.558334, 0.829617,  0.324740,
              0.325372, 0.945586,  0.568623,
              -0.065729, 0.997838,  0.543237,
              0.519949, 0.854197,  -0.154356,
              0.999764, -0.021703,  0.323838,
              0.777350, 0.629068,  -0.302238,
              0.942298, 0.334776,  0.261145,
              0.746499, 0.665386,  0.706382,
              0.200193, 0.979757,  -0.617471,
              0.547683, 0.836686,  1.089125,
              0.905733, 0.423848,  0.621759,
              -0.267698, 0.963503,  -0.757836,
              0.574085, 0.818796,  -0.412164,
              0.296470, 0.955042,  0.983421,
              -0.110884, 0.993833,  -0.485476,
              -0.169424, 0.985543,  0.297432,
              0.906852, 0.421450,  -0.511450,
              0.711178, 0.703012,  2.461511,
              0.926196, 0.377043,  0.917630,
              0.989573, -0.144030,  -0.227582,
              -0.070517, 0.997511,  -1.073320,
              0.820441, 0.571731,  1.171953,
              0.621545, 0.783378,  -0.692513,
              0.997855, 0.065460,  1.111441,
              0.992861, 0.119277,  1.433413,
              0.778380, 0.627793,  -0.986827,
              0.606619, 0.794993,  -1.723950,
              0.972159, 0.234323,  -0.796150,
              0.268179, 0.963369,  1.602184,
              0.059826, 0.998209,  -1.409821,
              -0.000007, 1.000000,  -0.807136,
              0.801764, 0.597641,  1.448836,
              -0.023742, 0.999718,  -1.673271,
              0.998356, -0.057324,  -0.589210,
              0.406428, 0.913683,  -1.105306,
              0.368482, 0.929635,  -1.986131,
              0.944178, 0.329436,  1.177597,
              0.013076, 0.999915,  0.999490,
              0.706546, 0.707668,  1.852964,
              0.999667, -0.025786,  0.840474,
              0.992304, 0.123827,  -1.143481,
              -0.493821, 0.869564,  -1.491106,
              0.841794, 0.539800,  -2.184201,
              0.330214, 0.943906,  0.265321,
              0.167145, 0.985932,  1.318250,
              0.031227, 0.999512,  -0.066335,
              0.969108, 0.246638,  1.664678,
              0.838460, 0.544964,  -1.238650,
              0.837604, 0.546277,  2.870479,
              0.681421, 0.731892,  -2.334966,
              -0.197487, 0.980306,  -2.456398,
              0.804272, 0.594262,  -0.727741,
              0.809175, 0.587568,  2.071242,
              0.891248, 0.453516,  -1.632031,
              0.476028, 0.879430,  0.791653,
              0.642540, 0.766252,  -1.282703,
              0.941297, 0.337579,  2.201356,
              0.468427, 0.883502,  1.399178,
              0.472973, 0.881077,  1.887119,
              0.387616, 0.921821,  -1.459624,
              0.430611, 0.902538,  -0.823091,
              0.551349, 0.834275,  -3.395361,
              0.576829, 0.816865,  2.203290,
              0.306636, 0.951827,  -2.602763,
              -0.334242, 0.942487,  -1.924247,
              -0.307418, 0.951575,  -1.212204,
              0.987727, 0.156190,  -1.438117,
              -0.255679, 0.966762,  -2.187600,
              -0.246073, 0.969251,  -1.526407,
              0.269390, 0.963031,  -1.738950,
              0.760169, 0.649726,  -2.700481,
              0.922770, 0.385351,  2.534137,
              0.996573, -0.082723,  0.580039,
              0.933054, 0.359737,  -1.043110,
              0.744543, 0.667575,  -3.317332,
              0.901207, 0.433388,  1.881127,
              0.731940, 0.681369,  -1.515980,
              0.812598, 0.582824,  -2.970790,
              0.054490, 0.998514,  -2.551292,
              0.103939, 0.994584,  0.753649,
              0.591258, 0.806482,  1.622024,
              0.200610, 0.979671,  -2.936713,
              0.932072, 0.362274,  -1.911506,
              0.263294, 0.964716,  -2.267207,
              0.064620, 0.997910,  -2.054475,
              0.691508, 0.722369,  2.739111,
              0.881424, 0.472326,  -2.437028,
              -0.321566, 0.946887,  -0.339851,
              -0.421595, 0.906784,  -0.978063,
              0.569952, 0.821678,  -2.560021,
              0.979579, 0.201062,  1.979649), nrow = 101, ncol = 3, byrow = TRUE)

# Computar e vizualizar a regiao de Tukey
Tr1 <- TukeyRegion(X, 1, method = "cmb", 
                   retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)

plot(Tr1, colorFacets = "red", colorRidges = "red", 
     colorPoints = "blue", alpha = 0.35)

# print("O baricentro :")
# print (Tr1$barycenter)
# (Tr1$barycenter)
# #  media aritmetica
# T.mean <- colMeans(X)
# print("A media aritmetica :")
# print (T.mean)
# #  m?dia ponderada aparada de profundidade de Tukey (profundidade aproximada)
# T.approx1 <- depth.wm(X, 0.25)
# print ("A media ponderada : ")
# print (T.approx1)

# media ponderada aparada de profundidade de Tukey (profundidade exata)T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# print ("A media ponderada aparada de profundidade de Tukey: ")
# print (T.exact1)

# a mediana de TukeyTm <- TukeyMedian(X)
Tm <- TukeyMedian(X, algMedian = "bsbarydepth", 
                  method = "bfs",trgFacets = TRUE, 
                  retHalfspaces = FALSE, retHalfspacesNR = FALSE,
                  retInnerPoint = FALSE, retVertices = TRUE, 
                  retFacets = TRUE,retVolume = FALSE, 
                  retBarycenter = TRUE, 
                  verbosity = 1)
print ("A mediana de Tukey : ")
print (Tm$barycenter)
# B <- summary(Tm$barycenter)



# library("scatterplot3d") 
# 
# scatterplot3d(X, y=NULL, z=NULL,  angle = 30)



