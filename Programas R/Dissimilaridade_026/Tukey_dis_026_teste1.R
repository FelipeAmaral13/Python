# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
# Clear console
cat("\014") 

# Packages
require(TukeyRegion)
require(MASS)


# Ler o arquivo txt do k-fold
#arq_tex <- read.table("C:\\Users\\megan\\Desktop\\Biblioteca Virtual\\Mestrado\\T?picos Aprendizado de M?quina\\fs4\\PerComiteOut.txt")
#print (head(arq_tex)) # ver o k-fold

# dat <- as.matrix(arq_tex)#, nrow = 9, ncol = 5) #Transformar o txt em matriz

X <- matrix(c(-0.121437, 0.992599,  -0.160782,
              0.999922, -0.012521,  0.000000,
              0.881897, 0.471441,  0.000000,
              0.417481, 0.908686,  0.000000,
              0.897003, 0.442025,  0.315252,
              0.692990, 0.720947,  0.000000,
              0.033829, 0.999428,  -0.372773,
              0.090343, 0.995911,  0.000000,
              0.999375, 0.035346,  -0.670878,
              0.203174, 0.979143,  -0.685043,
              0.501086, 0.865397,  -0.563380,
              0.802863, 0.596163,  -0.244842,
              -0.368421, 0.929659,  -0.654961,
              -0.030738, 0.999527,  0.313516,
              0.357936, 0.933746,  -0.349496,
              0.887303, 0.461188,  0.823237,
              0.482569, 0.875858,  0.498867,
              0.976967, 0.213390,  -0.130699,
              0.991866, 0.127290,  0.284678,
              0.898738, 0.438486,  -0.461151,
              0.930893, 0.365291,  -1.462987,
              0.729669, 0.683801,  -0.565310,
              -0.059786, 0.998211,  -0.673012,
              0.596437, 0.802660,  -0.282914,
              -0.158947, 0.987287,  -0.972228,
              0.702473, 0.711711,  0.520914,
              0.561267, 0.827635,  0.232909,
              0.227286, 0.973828,  1.429021,
              0.158140, 0.987417,  -1.476085,
              0.218530, 0.975830,  0.467402,
              0.996428, 0.084446,  0.577325,
              0.990624, -0.136620,  0.258194,
              0.998253, 0.059077,  -0.397852,
              0.177877, 0.984053,  0.861145,
              -0.312934, 0.949775,  -0.350897,
              0.999694, 0.024723,  0.977822,
              0.497954, 0.867203,  -2.372945,
              -0.395670, 0.918393,  -1.260568,
              0.921111, 0.389301,  -2.015337,
              0.771646, 0.636052,  1.484164,
              -0.215185, 0.976573,  0.086902,
              0.935859, 0.352375,  -0.891940,
              0.801418, 0.598105,  2.661048,
              0.512723, 0.858554,  1.825084,
              0.927333, 0.374236,  1.172999,
              0.830183, 0.557491,  -2.403542,
              0.765404, 0.643550,  1.849406,
              0.791695, 0.610916,  -0.941941,
              0.641687, 0.766967,  1.265540,
              0.489845, 0.871810,  -1.717801,
              0.289692, 0.957120,  -1.099742,
              0.988545, -0.150930,  -0.226800,
              0.990556, 0.137112,  -1.166058,
              0.934604, 0.355690,  0.557788,
              0.978234, 0.207503,  1.423293,
              0.618049, 0.786140,  -0.806985,
              0.725188, 0.688551,  0.780882,
              0.436428, 0.899739,  0.899572,
              -0.003317, 0.999994,  0.654218,
              0.930047, 0.367440,  1.688180,
              0.233100, 0.972453,  -2.948450,
              0.939468, 0.342636,  2.105751,
              0.597854, 0.801605,  -1.194765,
              0.282223, 0.959349,  1.133441,
              0.647677, 0.761915,  2.117242,
              0.780746, 0.624848,  1.042028,
              0.908210, 0.418515,  -1.196633,
              0.658706, 0.752400,  -1.537853,
              0.251678, 0.967811,  0.208857,
              -0.065276, 0.997867,  -2.770053,
              -0.300948, 0.953640,  -1.647445,
              0.510731, 0.859741,  1.512885,
              0.746145, 0.665783,  2.342551,
              0.758043, 0.652204,  0.246619,
              0.946511, 0.322672,  2.469442,
              -0.069794, 0.997561,  -1.231860,
              0.104616, 0.994513,  -1.920911,
              0.422083, 0.906557,  2.067394,
              0.164220, 0.986424,  -3.221459,
              0.808958, 0.587867,  2.979758,
              0.455691, 0.890138,  -2.818098,
              0.278588, 0.960411,  1.743597,
              0.829627, 0.558317,  -1.711530,
              -0.066615, 0.997779,  -2.434191,
              0.721950, 0.691945,  -2.002987,
              0.918236, 0.396034,  2.833697,
              0.533650, 0.845705,  2.377177,
              0.865288, 0.501276,  -2.725260,
              0.164056, 0.986451,  -2.599541,
              -0.150134, 0.988666,  -2.091313,
              -0.461918, 0.886923,  -0.975343,
              0.706820, 0.707394,  -2.667634,
              0.979706, 0.200439,  1.889658,
              0.219528, 0.975606,  -2.162723,
              0.605163, 0.796102,  -3.310934,
              0.418831, 0.908064,  -1.449349,
              0.588934, 0.808181,  -3.598127,
              0.789436, 0.613832,  -3.167267,
              0.778913, 0.627132,  -1.294885,
              0.478947, 0.877844,  -2.019702,
              0.979352, 0.202164,  -1.741013), nrow = 101, ncol = 3, byrow = TRUE)

# Computar e vizualizar a regiao de Tukey
Tr1 <- TukeyRegion(X, 1, method = "cmb", 
                   retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)

plot(Tr1, colorFacets = "red", colorRidges = "red", 
     colorPoints = "blue", alpha = 0.35)

# print("O baricentro :")
# print (Tr1$barycenter)
# (Tr1$barycenter)
# #  media aritmetica
# T.mean <- colMeans(X)
# print("A media aritmetica :")
# print (T.mean)
# #  m?dia ponderada aparada de profundidade de Tukey (profundidade aproximada)
# T.approx1 <- depth.wm(X, 0.25)
# print ("A media ponderada : ")
# print (T.approx1)

# media ponderada aparada de profundidade de Tukey (profundidade exata)T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# print ("A media ponderada aparada de profundidade de Tukey: ")
# print (T.exact1)

# a mediana de TukeyTm <- TukeyMedian(X)
Tm <- TukeyMedian(X, algMedian = "bsbarydepth", 
                  method = "bfs",trgFacets = TRUE, 
                  retHalfspaces = FALSE, retHalfspacesNR = FALSE,
                  retInnerPoint = FALSE, retVertices = TRUE, 
                  retFacets = TRUE,retVolume = FALSE, 
                  retBarycenter = TRUE, 
                  verbosity = 1)
print ("A mediana de Tukey : ")
print (Tm$barycenter)
# B <- summary(Tm$barycenter)



# library("scatterplot3d") 
# 
# scatterplot3d(X, y=NULL, z=NULL,  angle = 30)



