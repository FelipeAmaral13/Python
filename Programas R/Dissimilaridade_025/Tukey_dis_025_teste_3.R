# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
# Clear console
cat("\014") 

# Packages
require(TukeyRegion)
require(MASS)


# Ler o arquivo txt do k-fold
#arq_tex <- read.table("C:\\Users\\megan\\Desktop\\Biblioteca Virtual\\Mestrado\\T?picos Aprendizado de M?quina\\fs4\\PerComiteOut.txt")
#print (head(arq_tex)) # ver o k-fold

# dat <- as.matrix(arq_tex)#, nrow = 9, ncol = 5) #Transformar o txt em matriz

X <- matrix(c(-0.086503, 0.996252,  -0.209559,
              0.984413, -0.175871,  0.042191,
              0.984134, 0.177427,  0.000000,
              0.548768, 0.835975,  0.000000,
              0.061953, 0.998079,  0.000000,
              0.990242, 0.139361,  0.319167,
              0.744723, 0.667373,  0.221981,
              0.839570, 0.543252,  0.000000,
              0.304293, 0.952578,  -0.491954,
              0.336708, 0.941609,  0.175154,
              0.923988, 0.382421,  0.242122,
              -0.246879, 0.969046,  -0.734354,
              -0.069218, 0.997602,  -0.522950,
              0.319252, 0.947670,  -0.169818,
              0.913059, 0.407827,  -0.374224,
              0.702524, 0.711660,  -0.221767,
              -0.050299, 0.998734,  0.244936,
              0.545493, 0.838115,  -0.696802,
              -0.233628, 0.972326,  0.000000,
              0.999341, -0.036285,  -0.166360,
              0.983903, 0.178702,  -0.729950,
              -0.327613, 0.944812,  -0.396609,
              0.518893, 0.854839,  1.272259,
              0.366978, 0.930230,  -0.877641,
              0.156442, 0.987687,  -0.717185,
              0.655742, 0.754985,  -0.487620,
              0.995141, 0.098457,  -0.423094,
              0.920470, 0.390813,  0.597485,
              0.174822, 0.984600,  0.508061,
              0.699162, 0.714963,  0.625872,
              0.825863, 0.563871,  0.886390,
              0.999538, 0.030393,  0.933301,
              0.078417, 0.996921,  1.144722,
              0.878420, 0.477889,  -0.938753,
              0.743397, 0.668850,  -0.829668,
              -0.049872, 0.998756,  -0.991451,
              0.447546, 0.894261,  0.486871,
              0.958877, 0.283822,  -1.328973,
              0.089655, 0.995973,  -1.587873,
              0.653336, 0.757068,  1.028306,
              -0.274474, 0.961595,  -1.192810,
              0.323465, 0.946240,  -1.790720,
              0.991188, 0.132465,  0.590693,
              0.666091, 0.745871,  -1.215280,
              0.217950, 0.975960,  0.758626,
              -0.445366, 0.895348,  -1.491549,
              0.441116, 0.897450,  0.915530,
              0.540057, 0.841629,  -2.484131,
              0.323147, 0.946349,  -2.946219,
              0.908929, 0.416951,  -0.670489,
              0.817118, 0.576471,  1.173317,
              0.293334, 0.956010,  1.501503,
              -0.030689, 0.999529,  0.670317,
              0.317871, 0.948134,  -1.257312,
              0.884674, 0.466210,  2.854032,
              0.910497, 0.413516,  -1.834612,
              0.766704, 0.642001,  2.119113,
              0.860155, 0.510033,  2.515109,
              0.973392, 0.229145,  1.184275,
              -0.072930, 0.997337,  -2.455015,
              0.993521, -0.113651,  0.329284,
              -0.421625, 0.906770,  -0.994504,
              0.928643, 0.370974,  2.257229,
              -0.010390, 0.999946,  -2.183632,
              0.753122, 0.657881,  1.655275,
              0.828468, 0.560037,  1.430201,
              0.554763, 0.832008,  -1.573846,
              0.546804, 0.837260,  0.263393,
              0.835873, 0.548922,  0.422539,
              0.894486, 0.447096,  -2.262980,
              0.996813, 0.079769,  -1.178676,
              -0.089339, 0.996001,  -1.897566,
              0.506232, 0.862397,  -0.318207,
              0.959772, 0.280781,  0.893137,
              -0.204491, 0.978868,  -1.563783,
              -0.004737, 0.999989,  -1.340132,
              0.547745, 0.836645,  1.774486,
              0.281362, 0.959602,  -2.248361,
              0.560185, 0.828368,  2.377412,
              0.706166, 0.708046,  -1.744705,
              0.638843, 0.769337,  -2.136520,
              0.930443, 0.366437,  1.781341,
              0.991225, 0.132187,  1.605752,
              0.860317, 0.509760,  -1.605437,
              0.791012, 0.611801,  -3.181549,
              0.409404, 0.912353,  2.020917,
              0.970411, 0.241460,  -0.987590,
              -0.377068, 0.926186,  -1.892916,
              0.963642, 0.267197,  -1.611848,
              1.000000, -0.000460,  -0.905053,
              0.707911, 0.706301,  2.829101,
              0.944665, 0.328038,  1.442809,
              0.528471, 0.848951,  -3.466926,
              0.587269, 0.809392,  1.527855,
              0.818383, 0.574674,  -2.054886,
              0.088908, 0.996040,  -2.806955,
              0.286804, 0.957989,  1.804912,
              0.954701, 0.297565,  -2.066941,
              0.976507, 0.215488,  2.028676,
              0.345346, 0.938475,  -2.683658,
              0.586925, 0.809641,  -0.976348), nrow = 101, ncol = 3, byrow = TRUE)

# Computar e vizualizar a regiao de Tukey
Tr1 <- TukeyRegion(X, 1, method = "cmb", 
                   retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)

plot(Tr1, colorFacets = "red", colorRidges = "red", 
     colorPoints = "blue", alpha = 0.35)

# print("O baricentro :")
# print (Tr1$barycenter)
# (Tr1$barycenter)
# #  media aritmetica
# T.mean <- colMeans(X)
# print("A media aritmetica :")
# print (T.mean)
# #  m?dia ponderada aparada de profundidade de Tukey (profundidade aproximada)
# T.approx1 <- depth.wm(X, 0.25)
# print ("A media ponderada : ")
# print (T.approx1)

# media ponderada aparada de profundidade de Tukey (profundidade exata)T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# T.exact1 <- depth.wm(X, 0.25, exact = TRUE)
# print ("A media ponderada aparada de profundidade de Tukey: ")
# print (T.exact1)

# a mediana de TukeyTm <- TukeyMedian(X)
Tm <- TukeyMedian(X, algMedian = "bsbarydepth", 
                  method = "bfs",trgFacets = TRUE, 
                  retHalfspaces = FALSE, retHalfspacesNR = FALSE,
                  retInnerPoint = FALSE, retVertices = TRUE, 
                  retFacets = TRUE,retVolume = FALSE, 
                  retBarycenter = TRUE, 
                  verbosity = 1)
print ("A mediana de Tukey : ")
print (Tm$barycenter)
# B <- summary(Tm$barycenter)



# library("scatterplot3d") 
# 
# scatterplot3d(X, y=NULL, z=NULL,  angle = 30)



